{% extends "base.html" %}

{% block content %}
<div class="container">
    <h1>Results Archive for {{ horse.name }}</h1>

    {% if results %}
        <ul>
            {% for result in results %}
    <li>
        <strong>{{ result.event.title }}</strong><br>
        Date: {{ result.event.start_time|date:"Y-m-d" }}<br>
        Class Details: {{ result.class_details }}<br>
        Height: {{ result.jump_height_str }}<br>
        Faults: {{ result.number_of_faults }}<br>
        Notes: {{ result.results|default:"No results yet" }}<br>

        <!-- Display Performance Rating with SVG Stars -->
        Performance Rating:
        {% if result.performance_rating %}
            {% with result.performance_rating|add:"0" as rating %}
                {% for i in "12345" %}
                    <svg height="20" viewBox="0 0 576 512" class="{% if i|add:"0" <= rating %}star-{{ rating }}{% else %}star-empty{% endif %}">
                        <path d="M316.9 18C311.6 7 300.4 0 288.1 0s-23.4 7-28.8 18L195 150.3 51.4 171.5c-12 1.8-22 10.2-25.7 21.7s-.7 24.2 7.9 32.7L137.8 329 113.2 474.7c-2 12 3 24.2 12.9 31.3s23 8 33.8 2.3l128.3-68.5 128.3 68.5c10.8 5.7 23.9 4.9 33.8-2.3s14.9-19.3 12.9-31.3L438.5 329 542.7 225.9c8.6-8.5 11.7-21.2 7.9-32.7s-13.7-19.9-25.7-21.7L381.2 150.3 316.9 18z"></path>
                    </svg>
                {% endfor %}
            {% endwith %}
        {% else %}
            Not Rated
        {% endif %}
    </li>
{% endfor %}

{% endif %} 

</div>

<!-- Performance Tracking Data -->
<div class="container">
    <h1>Performance Archive for {{ horse.name }}</h1>
    
    <canvas id="performanceChart"></canvas>

    <script>
        var performanceData = {
            dates: {{ dates|safe }},
            ratings: {{ ratings|safe }},
            jump_heights: {{ jump_heights|safe }},
            faults: {{ faults|safe }},
        };
    </script>
</div>
{% endblock %}
